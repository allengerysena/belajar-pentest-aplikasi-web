FROM wordpress:5.8.2

RUN apt-get update && apt-get install -y \
    wget \
    unzip \
    && rm -rf /var/lib/apt/lists/*

# CVE-2021-24155
RUN wget https://downloads.wordpress.org/plugin/contact-form-7.5.3.2.zip -O /tmp/contact-form-7.zip \
    && unzip /tmp/contact-form-7.zip -d /usr/src/wordpress/wp-content/plugins/ \
    && rm /tmp/contact-form-7.zip

# CVE-2022-29455
RUN wget https://downloads.wordpress.org/plugin/download-manager.3.2.48.zip -O /tmp/download-manager.zip \
    && unzip /tmp/download-manager.zip -d /usr/src/wordpress/wp-content/plugins/ \
    && rm /tmp/download-manager.zip

# CVE-2019-9978
RUN wget https://downloads.wordpress.org/plugin/social-warfare.3.5.2.zip -O /tmp/social-warfare.zip \
    && unzip /tmp/social-warfare.zip -d /usr/src/wordpress/wp-content/plugins/ \
    && rm /tmp/social-warfare.zip

# CVE-2020-36100
RUN wget https://downloads.wordpress.org/plugin/give.2.7.3.zip -O /tmp/give.zip \
    && unzip /tmp/give.zip -d /usr/src/wordpress/wp-content/plugins/ \
    && rm /tmp/give.zip

RUN chown -R www-data:www-data /usr/src/wordpress/wp-content/plugins

ENV WORDPRESS_DB_HOST=db:3306
ENV WORDPRESS_DB_USER=wordpress
ENV WORDPRESS_DB_PASSWORD=wordpress
ENV WORDPRESS_DB_NAME=wordpress

EXPOSE 80

CMD ["apache2-foreground"]
